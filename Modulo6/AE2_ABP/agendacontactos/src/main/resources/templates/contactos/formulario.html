<!DOCTYPE html>
<html lang="es" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title th:text="${accion} + ' Contacto - Agenda'">Formulario Contacto</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">

</head>
<body class="bg-light">
    <!-- Navbar -->
    <nav class="navbar navbar-expand-lg navbar-dark bg-primary shadow">
        <div class="container">
            <a class="navbar-brand fw-bold" th:href="@{/}">
                <i class="fas fa-address-book me-2"></i>
                Agenda de Contactos
            </a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarNav">
                <div class="navbar-nav ms-auto">
                    <a class="nav-link" th:href="@{/}">
                        <i class="fas fa-home me-1"></i>Inicio
                    </a>
                    <a class="nav-link" th:href="@{/contactos/listar}">
                        <i class="fas fa-list me-1"></i>Ver Todos
                    </a>
                    <a class="nav-link active" th:href="@{/contactos/nuevo}">
                        <i class="fas fa-plus me-1"></i>Nuevo Contacto
                    </a>
                </div>
            </div>
        </div>
    </nav>

    <!-- Form Header -->
    <section class="bg-primary text-white py-4 mb-4">
        <div class="container">
            <div class="row justify-content-center text-center">
                <div class="col-md-8">
                    <div class="bg-white rounded-circle mx-auto mb-3 d-flex align-items-center justify-content-center" 
                         style="width: 60px; height: 60px;">
                        <i class="fas text-primary fs-4" th:classappend="${accion == 'Crear'} ? 'fa-plus' : 'fa-edit'"></i>
                    </div>
                    <h1 class="display-5 fw-bold mb-2" th:text="${accion} + ' Contacto'">Formulario Contacto</h1>
                    <p class="lead" th:text="${accion == 'Crear'} ? 'Agrega un nuevo contacto a tu agenda' : 'Actualiza la información del contacto'">
                        Completa la información del contacto
                    </p>
                </div>
            </div>
        </div>
    </section>

    <div class="container">
        <div class="row justify-content-center">
            <div class="col-md-8 col-lg-6">
                <!-- Formulario Principal -->
                <div class="card shadow">
                    <div class="card-body p-4">
                        <form th:action="${contacto.id != null} ? @{/contactos/{id}/editar(id=${contacto.id})} : @{/contactos/nuevo}" 
                              method="post" 
                              th:object="${contacto}">
                            
                            <!-- Campo oculto para ID cuando se está editando -->
                            <input type="hidden" th:field="*{id}" th:if="${contacto.id != null}">
                            
                            <!-- Nombre -->
                            <div class="form-floating mb-3">
                                <input type="text" 
                                       class="form-control" 
                                       th:classappend="${#fields.hasErrors('nombre')} ? 'is-invalid' : ''"
                                       id="nombre" 
                                       th:field="*{nombre}"
                                       placeholder="Nombre completo">
                                <label for="nombre">
                                    <i class="fas fa-user me-2"></i>Nombre Completo
                                </label>
                                <div class="invalid-feedback" th:if="${#fields.hasErrors('nombre')}">
                                    <i class="fas fa-exclamation-circle me-1"></i>
                                    <span th:errors="*{nombre}">Error en nombre</span>
                                </div>
                            </div>

                            <!-- Correo -->
                            <div class="form-floating mb-3">
                                <input type="email" 
                                       class="form-control" 
                                       th:classappend="${#fields.hasErrors('correo')} ? 'is-invalid' : ''"
                                       id="correo" 
                                       th:field="*{correo}"
                                       placeholder="correo@ejemplo.com">
                                <label for="correo">
                                    <i class="fas fa-envelope me-2"></i>Correo Electrónico
                                </label>
                                <div class="invalid-feedback" th:if="${#fields.hasErrors('correo')}">
                                    <i class="fas fa-exclamation-circle me-1"></i>
                                    <span th:errors="*{correo}">Error en correo</span>
                                </div>
                            </div>

                            <!-- Teléfono -->
                            <div class="form-floating mb-3">
                                <input type="tel" 
                                       class="form-control" 
                                       th:classappend="${#fields.hasErrors('telefono')} ? 'is-invalid' : ''"
                                       id="telefono" 
                                       th:field="*{telefono}"
                                       placeholder="+56912345678">
                                <label for="telefono">
                                    <i class="fas fa-phone me-2"></i>Número de Teléfono
                                </label>
                                <div class="form-text mb-2">
                                    <i class="fas fa-info-circle me-1"></i>
                                    Formato: +56912345678 (8-15 dígitos, puede incluir +)
                                </div>
                                <div class="invalid-feedback" th:if="${#fields.hasErrors('telefono')}">
                                    <i class="fas fa-exclamation-circle me-1"></i>
                                    <span th:errors="*{telefono}">Error en teléfono</span>
                                </div>
                            </div>

                            <!-- Botones -->
                            <div class="row g-3 mt-2">
                                <div class="col-6">
                                    <a th:href="@{/contactos/listar}" class="btn btn-outline-secondary w-100">
                                        <i class="fas fa-arrow-left me-2"></i>Cancelar
                                    </a>
                                </div>
                                <div class="col-6">
                                    <button type="submit" class="btn btn-primary w-100">
                                        <i class="fas" th:classappend="${accion == 'Editar'} ? 'fa-edit' : 'fa-save'"></i>
                                        <span th:text="${accion == 'Editar'} ? ' Actualizar' : ' Guardar'">Guardar</span>
                                    </button>
                                </div>
                            </div>
                        </form>
                    </div>
                </div>

                <!-- Información de ayuda -->
                <div class="card bg-light mt-4">
                    <div class="card-body">
                        <h6 class="card-title text-center mb-3">
                            <i class="fas fa-lightbulb text-warning me-2"></i>
                            Consejos para completar el formulario
                        </h6>
                        <div class="row g-3 small">
                            <div class="col-12">
                                <div class="d-flex align-items-start">
                                    <div class="bg-primary rounded-circle me-3 d-flex align-items-center justify-content-center" 
                                         style="width: 25px; height: 25px;">
                                        <i class="fas fa-user text-white" style="font-size: 0.7rem;"></i>
                                    </div>
                                    <div>
                                        <strong>Nombre:</strong> Entre 2 y 50 caracteres. Incluye nombre y apellido.
                                    </div>
                                </div>
                            </div>
                            <div class="col-12">
                                <div class="d-flex align-items-start">
                                    <div class="bg-success rounded-circle me-3 d-flex align-items-center justify-content-center" 
                                         style="width: 25px; height: 25px;">
                                        <i class="fas fa-envelope text-white" style="font-size: 0.7rem;"></i>
                                    </div>
                                    <div>
                                        <strong>Correo:</strong> Dirección válida y única. Se usará para contacto.
                                    </div>
                                </div>
                            </div>
                            <div class="col-12">
                                <div class="d-flex align-items-start">
                                    <div class="bg-info rounded-circle me-3 d-flex align-items-center justify-content-center" 
                                         style="width: 25px; height: 25px;">
                                        <i class="fas fa-phone text-white" style="font-size: 0.7rem;"></i>
                                    </div>
                                    <div>
                                        <strong>Teléfono:</strong> 8-15 dígitos. Ejemplo: +56912345678 o 987654321
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>